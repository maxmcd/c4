syntax = "proto3";

package api;

import "google/api/annotations.proto";

// AuthService specifies the interface through which clients authenticate
service AuthService {
        rpc Authenticate(AuthenticateRequest)
                returns (AuthenticateResponse) {
                        option (google.api.http) = {
                                post: "/v0/authenticate"
                                body: "*"
                        };
                }
        rpc AuthenticateEmail(AuthenticateEmailRequest)
                returns (AuthenticateEmailResponse) {
                        option (google.api.http) = {
                                post: "/v0/authenticate/email"
                                body: "*"
                        };
                }
        rpc RegisterEmail(RegisterEmailRequest)
                returns (RegisterEmailResponse) {
                        option (google.api.http) = {
                                post: "/v0/authenticate/email/register"
                                body: "*"
                        };
                }
        rpc SmsCodeCheck(SmsCodeCheckRequest)
                returns (SmsCodeCheckResponse) {
                        option (google.api.http) = {
                                post: "/v0/authenticate/sms-code-check"
                                body: "*"
                        };
                }
}

message AuthenticateRequest {
    string phone = 1;
}

message AuthenticateResponse {
    string request_id = 1;
}

message AuthenticateEmailRequest {
    string email = 1;
    string password = 2;
}

message AuthenticateEmailResponse {
    string token = 1;
    uint64 user_id = 2;
}

message RegisterEmailRequest {
    string email = 1;
    string password = 2;
}

message RegisterEmailResponse {
    string token = 1;
    uint64 user_id = 2;
}

message SmsCodeCheckRequest {
    string phone = 1;
    string request_id = 2;
    string code = 3;
}

message SmsCodeCheckResponse {
    string token = 1;
    string username = 2;
    uint64 user_id = 3;
}
